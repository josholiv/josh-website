---
import BaseLayout from '../layouts/BaseLayout.astro';
import ChessStats from '../components/chesscom.tsx';
import Strava from "../components/strava.js";
import ErrorRenderer from "../Error.astro";

const pageTitle = "About Me";
const identity = {
  firstName: "Josh",
  country: "the United States",
  occupation: "research assistant",
  hobbies: ["yerba mate🧉", "3D printing⚙️", "chess♟️", "yoyo tricks🪀", "triathlons🏃‍♂️"],
	};
const hobbyText = identity.hobbies.slice(0, -1).join(", ") + ", and " + identity.hobbies.at(-1);
const skills = ["HTML", "CSS", "JavaScript", "React", "Astro", "Writing Docs"];
const happy = true;
const finished = true;
const goal = 3;
const skillColor = "red";
const fontWeight = "bold";
const textCase = "uppercase";
const currentYear = new Date().getFullYear();

// Display error message if Strava API messes up
let data, error
try {
  const strava = new Strava()
  data = await strava.fetch()
} catch (e) {
  error = e.message
  if (error.includes("401")) {
    throw Error(
      "Something went wrong with the Strava API, try updating your refresh_token",
    )
  }
}
---
<BaseLayout pageTitle={pageTitle}>
	<h2>Hi, I'm {identity.firstName}!</h2>
    <p>I live in {identity.country} and work as a {identity.occupation}.</p>
    <p>I love {hobbyText}.</p>
	<p>During my triathlon training in <strong>{currentYear}</strong>, I've gone a total of</p>
		{
		  !error && (
			<p>
			  🏊 <strong style={{ fontSize: '1.5em', color: '#0077cc' }}>{data.swimDistance}*</strong> 
			  (<span style={{ fontSize: '1.2em', color: '#0077cc' }}>{data.swimDistanceKm} km</span>) swimming, <br />
	  
			  🚴 <strong style={{ fontSize: '1.5em', color: '#41ab5d' }}>{data.rideDistance}*</strong> 
			  (<span style={{ fontSize: '1.2em', color: '#41ab5d' }}>{data.rideDistanceKm} km</span>) biking, and<br />
	  
			  🏃‍♂️ <strong style={{ fontSize: '1.5em', color: '#ffaa00' }}>{data.runDistance}*</strong> 
			  (<span style={{ fontSize: '1.2em', color: '#ffaa00' }}>{data.runDistanceKm} km</span>) running*
			</p>
		  )
		}
	
	<ErrorRenderer error={error} />
	
	<ChessStats client:load />

	<p class="footnote">*Data from my <a href="https://www.strava.com/athletes/26573817" target="_blank" rel="noopener noreferrer">Strava</a> profile</p>
	<p class="footnote">**Data from my <a href="https://www.chess.com/member/pichugang" target="_blank" rel="noopener noreferrer">Chess.com</a> profile</p>
</BaseLayout>