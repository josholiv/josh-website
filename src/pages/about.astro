---
import BaseLayout from '../layouts/BaseLayout.astro';
import ChessStats from '../components/chesscom.tsx';
import Strava from "../components/strava.js";
import ErrorRenderer from "../Error.astro";

const pageTitle = "About Me";
const identity = {
  firstName: "Josh",
  country: "the United States",
  occupation: "research assistant",
  hobbies: ["3D printing", "yoyo tricks🪀", "yerba mate🧉", "chess♟️", "triathlons"],
	};
const hobbyText = identity.hobbies.slice(0, -1).join(", ") + ", and " + identity.hobbies.at(-1);
const skills = ["HTML", "CSS", "JavaScript", "React", "Astro", "Writing Docs"];
const happy = true;
const finished = true;
const goal = 3;
const skillColor = "red";
const fontWeight = "bold";
const textCase = "uppercase";
const currentYear = new Date().getFullYear();

// Display error message if Strava API messes up
let data, error
try {
  const strava = new Strava()
  data = await strava.fetch()
} catch (e) {
  error = e.message
  if (error.includes("401")) {
    throw Error(
      "Something went wrong with the Strava API, try updating your refresh_token",
    )
  }
}
---
<BaseLayout pageTitle={pageTitle}>
	<h2>Hi, I'm {identity.firstName}!</h2>
    <p>I live in {identity.country} and work as a {identity.occupation}.</p>
    <p>I love {hobbyText}.</p>
    <p>In {currentYear}, I've gone the following distances swimming🏊, biking🚴, and running🏃‍♂️:</h3>
  
	<p>
	  {
		!error && (
		  <>
			🏊 <strong>{data.swimDistance}</strong> ({data.swimDistanceKm} km) <br />
			🚴 <strong>{data.rideDistance}</strong> ({data.rideDistanceKm} km) <br />
			🏃‍♂️ <strong>{data.runDistance}</strong> ({data.runDistanceKm} km)
		  </>
		)
	  }    
	</p>
	
	<ErrorRenderer error={error} />

	<p>(Data from my <a href=`https://www.strava.com/athletes/26573817` target="_blank">Strava</a> profile)</p>
	
  My current bullet chess rating is:
	<ChessStats client:load />
</BaseLayout>